"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.LevelupBatch = void 0;
class LevelupBatch {
    constructor(db) {
        this.queue = [];
        this.db = db;
    }
    get size() {
        return this.queue.length;
    }
    putEncoded(key, value) {
        this.queue.push({ type: 'put', key: key, value: value });
        return this;
    }
    delEncoded(key) {
        this.queue.push({ type: 'del', key: key });
        return this;
    }
    put(store, key, value) {
        const [encodedKey, encodedValue] = store.encode(key, value);
        return this.putEncoded(encodedKey, encodedValue);
    }
    del(store, key) {
        const [encodedKey] = store.encode(key);
        return this.delEncoded(encodedKey);
    }
    async commit() {
        if (this.queue.length === 0) {
            return;
        }
        await this.db.levelup.batch(this.queue);
        this.queue.length = 0;
    }
}
exports.LevelupBatch = LevelupBatch;
//# sourceMappingURL=batch.js.map